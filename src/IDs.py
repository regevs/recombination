# ---------------------------------------------------------------------------------
# Parameters
pacbio_sequel_params = {
    "high_confidence_slack": 10,
    "base_qual_min_detection": 60,
    "base_qual_min_classification": 30,
    "read_trimming_detection": 1500,
    "read_trimming_classification": 500,
    "certainty_threshold": 0.95,
    "map_qual_min": 60,
    "total_mismatches_max": 100,
    "total_clipping_max": 10,
    "phased_coverage_min": 3,
    "allele_coverage_min": 3,
    "GC_tract_mean": 30,
    "read_margin_in_bp": 5000,
}

pacbio_revio_binned_params = {
    "high_confidence_slack": 10,
    "base_qual_min_detection": 40,
    "base_qual_min_classification": 30,
    "read_trimming_detection": 400,
    "read_trimming_classification": 200,
    "certainty_threshold": 0.95,
    "map_qual_min": 60,
    "total_mismatches_max": 100,
    "total_clipping_max": 10,
    "phased_coverage_min": 3,
    "allele_coverage_min": 3,
    "GC_tract_mean": 30,
    "read_margin_in_bp": 5000,
}


# ---------------------------------------------------------------------------------
# Chrom lists

aut_chrom_names = [f"chr{i}" for i in list(range(1, 23))]
chrom_names = aut_chrom_names + ["chrX", "chrY"]

aut_chrom_names_ragtag = [x + "_RagTag" for x in aut_chrom_names]
chrom_names_ragtag = [x + "_RagTag" for x in chrom_names]

# ---------------------------------------------------------------------------------
# Sample lists

# Samples to do
rahbari_sample_ids = [
    "PD50477f",
    # "PD50508bf", -- ignore; merged two sampling dates just for phasing, but should be analyzed separately
    "PD50519d",
    # "PD47269d", -- don't use, not there
    "PD50508f",
    # "PD50511e", -- don't use, likely mixture
    "PD50523b",
    # "PD48473b", -- don't use, not there
    "PD50521b",
    "PD50508b",
    # "PD50521be", -- ignore; merged two sampling dates just for phasing, but should be analyzed separately
    "PD46180c",
    # "PD50502f", -- don't use, likely mixture
    "PD50521e",
    # "PD50511e_SS",  --- don't use
    "PD50489e",
]

sudmant_sample_ids = [    
    "1894",
    "3898",
    "7899",
    "95619",
    "115980",
    "2895",
    # "105621", -- weird assembly, takes a long time, errors, and CO reads are x5 what they should be
    # "6901",  --- weird assembly, maybe contamination?
    # "8900",  --- surprisingly low coverage
]

normal_sample_ids = [
    "PD47269d",
    "PD48473b",
]

# NA12877,NA12878,NA12879,NA12881,NA12882,NA12885,NA12886,NA12889,NA12890,NA12891,NA12892,200082,200084,200085,200086,200087,200100,200101,200102,200104,200106
# samples with filtered.fastq.gz as of 4.11.2024 - 200082,200087,200100,200102,200104,200106,NA12877,NA12882,NA12885,NA12892
# as of 5.11.2024 - 200080,200082,200086,200087,200100,200102,200104,200106,NA12877,NA12879,NA12881,NA12882,NA12885,NA12886,NA12892
# as of 6.11.2024 - 200082,200084,200086,200087,200101,200102,200104,200106,NA12877,NA12879,NA12881,NA12882,NA12885,NA12886,NA12890,NA12891,NA12892
# as of 10.11.2024 - 200082,200084,200085,200086,200087,200101,200102,200104,200106,NA12877,NA12878,NA12879,NA12881,NA12882,NA12885,NA12886,NA12890,NA12891,NA12892
ceph_sample_ids = [
    "NA12877",
    "NA12878",
    "NA12879",
    "NA12881",
    "NA12882",
    "NA12885",
    "NA12886",
   # "NA12887", -- not there yet?
    "NA12889",
    "NA12890",
    "NA12891",
    "NA12892",
    # "200080", -- different fasta format, deal later
    "200082",
    "200084",
    "200085",
    "200086",
    "200087",
    # "200100", -- different fasta format, deal later
    "200101",
    "200102",
    "200104",
    "200106",
]


sample_ids = rahbari_sample_ids + sudmant_sample_ids

sample_id_to_joint_id = {
    "PD50477f": "PD50477f",
    "PD50519d": "PD50519d",
    "PD50508f": "PD50508bf",
    "PD50523b": "PD50523b",
    "PD50521b": "PD50521be",
    "PD50508b": "PD50508bf",
    "PD46180c": "PD46180c",
    "PD50521e": "PD50521be",
    "PD50489e": "PD50489e",
    "1894": "1894",
    "3898": "3898",
    "7899": "7899",
    "95619": "95619",
    "115980": "115980",
    "2895": "2895",
    "PD47269d": "PD47269d",
    "PD48473b": "PD48473b",
    #"105621": "105621",
    #"6901": "6901",
    #"8900": "8900",
    "NA12877": "NA12877",
    "NA12878": "NA12878",
    "NA12879": "NA12879",
    "NA12881": "NA12881",
    "NA12882": "NA12882",
    "NA12885": "NA12885",
    "NA12886": "NA12886",
    "NA12887": "NA12887",
    "NA12889": "NA12889",
    "NA12890": "NA12890",
    "NA12891": "NA12891",
    "NA12892": "NA12892",
    "200080": "200080",
    "200082": "200082",
    "200084": "200084",
    "200085": "200085",
    "200086": "200086",
    "200087": "200087",
    "200100": "200100",
    "200101": "200101",
    "200102": "200102",
    "200104": "200104",
    "200106": "200106",
}


sample_id_to_group_id = {
    "PD50477f": "PD50477f",
    "PD50519d": "PD46180c_PD50519d",
    "PD50508f": "PD50508bf",
    "PD50523b": "PD50523b",
    "PD50521b": "PD50521be",
    "PD50508b": "PD50508bf",
    "PD46180c": "PD46180c_PD50519d",
    "PD50521e": "PD50521be",
    "PD50489e": "PD50489e",
    "105621": "105621",
    "1894": "1894",
    "3898": "3898",
    "7899": "7899",
    "95619": "95619",
    "115980": "115980",
    "2895": "2895",
    "PD47269d": "PD47269d",
    "PD48473b": "PD48473b",
    "NA12877": "NA12877",
    "NA12878": "NA12878",
    "NA12879": "NA12879",
    "NA12881": "NA12881",
    "NA12882": "NA12882",
    "NA12885": "NA12885",
    "NA12886": "NA12886",
    "NA12887": "NA12887",
    "NA12889": "NA12889",
    "NA12890": "NA12890",
    "NA12891": "NA12891",
    "NA12892": "NA12892",
    "200080": "200080",
    "200082": "200082",
    "200084": "200084",
    "200085": "200085",
    "200086": "200086",
    "200087": "200087",
    "200100": "200100",
    "200101": "200101",
    "200102": "200102",
    "200104": "200104",
    "200106": "200106",
    "All": "All",
}


sample_id_to_paper_label = {
    "PD50508b": "AA1-s1",
    "PD50508f": "AA1-s2",
    "PD46180c": "AA2-t1",
    "PD50519d": "AA2-t2",
    "PD50477f": "AA3",
    "PD50489e": "AA4",
    "1894": "AA5",
    "3898": "AA6",
    "7899": "AA7",
    "95619": "AA8",
    "115980": "AA9",
    "PD50521b": "AN-s1",
    "PD50521e": "AN-s2",        
    "2895": "AB",
    "PD50523b": "AD",
#    "105621": "AC",
    "PD47269d": "PD47269d",
    "PD48473b": "PD48473b",
    "NA12877": "NA12877",
    "NA12878": "NA12878",
    "NA12879": "NA12879",
    "NA12881": "NA12881",
    "NA12882": "NA12882",
    "NA12885": "NA12885",
    "NA12886": "NA12886",
    "NA12887": "NA12887",
    "NA12889": "NA12889",
    "NA12890": "NA12890",
    "NA12891": "NA12891",
    "NA12892": "NA12892",
    "200080": "200080",
    "200082": "200082",
    "200084": "200084",
    "200085": "200085",
    "200086": "200086",
    "200087": "200087",
    "200100": "200100",
    "200101": "200101",
    "200102": "200102",
    "200104": "200104",
    "200106": "200106",
    "All": "All reads",
}

# ---------------------------------------------------------------------------------
# Sample to params
#
sample_to_params = {}
for sample_id in rahbari_sample_ids:
    sample_to_params[sample_id] = pacbio_sequel_params
for sample_id in sudmant_sample_ids:
    sample_to_params[sample_id] = pacbio_revio_binned_params
for sample_id in normal_sample_ids:
    sample_to_params[sample_id] = pacbio_sequel_params
for sample_id in ceph_sample_ids:
    sample_to_params[sample_id] = pacbio_revio_binned_params


# ---------------------------------------------------------------------------------
# Figures
#
darkgreen = '#9BC184'
midgreen = '#C2D6A4'
lightgreen = '#E7E5CB'
quantile_colors = [lightgreen, midgreen, darkgreen, midgreen, lightgreen]

nice_pallete = ["#F94144", "#F3722C", "#F8961E", "#F9C74F", "#90BE6D", "#43AA8B"]

CO_color = "C0"
NCO_color = "C2"
complex_color = "C1"
ambiguous_color = "C3"
background_color = "gray"

group_presentation_order = [
    'PD50508bf',
    'PD50477f',
    'PD46180c_PD50519d',
    'PD50489e',
    'PD50521be',
    'PD50523b',
    'All',
]


nco_group_presentation_order = [
    'PD50508bf',
    'PD50477f',
    'PD46180c',
    'PD50519d',
    'PD50489e',
    'PD50521be',
    'PD50523b',
    'All',
]

group_to_color = {
    'PD50508bf': "#F94144",
    'PD50477f': "#F3722C",
    'PD46180c_PD50519d': "#F8961E",
    'PD50489e': "#F9C74F",
    'PD50521be': "#90BE6D", 
    'PD50523b': "#43AA8B",
    "1894": "#F94144",
    "3898": "#F3722C",
    "7899": "#F8961E",
    "95619": "#F9C74F",
    "115980": "#90BE6D", 
    "2895": "#43AA8B",
    "105621": "#43AA8B",
    'All': "#577590",
}


nco_group_to_color = {
    'PD50508bf': "#F94144",
    'PD50477f': "#F3722C",
    'PD46180c': "#F8961E",
    'PD50519d': "#F8961E",
    'PD50489e': "#F9C74F",
    'PD50521be': "#90BE6D", 
    'PD50523b': "#43AA8B",
    'All': "#577590",
}

sample_presentation_order = [
    'PD50508b',
    'PD50508f',
    'PD46180c',
    'PD50519d',
    'PD50477f',
    'PD50489e',
    "1894",
    "3898",
    "7899",
    "95619",
    "115980",
    'PD50521b',
    'PD50521e',
    "2895",
    'PD50523b',
    'All',
]

sample_id_order = sample_presentation_order[:-1]

sample_to_color = {k:group_to_color[sample_id_to_group_id[k]] for k in sample_presentation_order}

# ---------------------------------------------------------------------------------
# Read blacklists

# From manual inspection 14-16.4.2024
NCO_read_blacklist = [
    'm64230e_220906_003948/60032580/ccs',
    'm64178e_220829_002441/25232978/ccs',
    'm64094e_220917_231317/155059512/ccs',
    'm64178e_220829_002441/62392396/ccs',
    'm64094e_220917_231317/96076942/ccs',
    'm64094e_220917_231317/74517145/ccs',
    'm64230e_220906_003948/52166986/ccs',
    'm64230e_220906_003948/11666271/ccs',
    'm64222e_220804_013319/56297546/ccs',
    'm64222e_220804_013319/41749151/ccs',
    'm64222e_220804_013319/45547932/ccs',
    'm64221e_220814_084225/164430634/ccs',
    'm64222e_220804_013319/43976808/ccs',
    'm64222e_220804_013319/47317891/ccs',
    'm64221e_220814_084225/86903563/ccs',
    'm64222e_220804_013319/22283946/ccs',
    'm64222e_220804_013319/116720068/ccs',
    'm64221e_220811_133409/30083306/ccs',
    'm64221e_220811_133409/86312411/ccs',
    'm64221e_220811_133409/57606928/ccs',
    'm64221e_220814_084225/42402180/ccs',
    'm64221e_220811_133409/156237854/ccs',
    'm64221e_220814_084225/135531048/ccs',
    'm64221e_220814_084225/61933374/ccs',
    'm64222e_220804_013319/52035891/ccs',
    'm64222e_220804_013319/24119431/ccs',
    'm64221e_220814_084225/130549150/ccs',
    'm64178e_220827_132801/55773773/ccs',
    'm64229e_220913_234845/18483464/ccs',
    'm64229e_220911_015559/67109081/ccs',
    'm64229e_220913_234845/165741700/ccs',
    'm64016e_220903_004635/179570014/ccs',
    'm64229e_220911_015559/178128607/ccs',
    'm64229e_220911_015559/38471137/ccs',
    'm64016e_220901_135237/110952989/ccs',
    'm64229e_220909_150132/99681901/ccs',
    'm64016e_220901_135237/21825066/ccs',
    'm64016e_220905_200242/98240161/ccs',
    'm64016e_220905_200242/149489318/ccs',
    'm64016e_220905_200242/108399242/ccs',
    'm64178e_220824_153720/138807483/ccs',
    'm64178e_220824_153720/179045405/ccs',
    'm64016e_220904_102424/137364734/ccs',
    'm64178e_220824_153720/160629818/ccs',
    'm64221e_220812_230038/113836394/ccs',
    'm64221e_220812_230038/1574852/ccs',
    'm64222e_220805_105329/39323876/ccs',
    'm64016e_220816_095555/81068543/ccs',
    'm64094e_220717_002414/66063090/ccs',
    'm64174e_220620_110709/129172237/ccs',
    'm64174e_220620_110709/60883267/ccs',
    'm64174e_220620_110709/62392404/ccs',
    'm64174e_220620_110709/56298290/ccs',
    'm64094e_220717_002414/82709011/ccs',
    'm64094e_220717_002414/129368391/ccs',
    'm64094e_220715_151527/7865396/ccs',
    'm64094e_220715_151527/8653118/ccs',
    'm64094e_220715_151527/161155192/ccs',
    'm64094e_220717_002414/110496448/ccs',
    'm64174e_220620_110709/104661259/ccs',
    'm64094e_220717_002414/20055042/ccs'
]

# From manual inspection 4.7.2024
control_CO_read_blacklist_PD47269d = [
    "m64125_201110_063134/31327573/ccs",
    "m64125_201110_063134/147718275/ccs",
    "m64125_201017_124255/131793774/ccs",
    "m64089_201023_192624/24709587/ccs",
    "m64125_201017_124255/27789883/ccs",
    "m64125_201110_063134/113903601/ccs",
    "m64125_201017_124255/169740836/ccs",
    "m64125_201110_063134/13109970/ccs",
    "m64125_201109_000332/54593681/ccs",
    "m64125_201109_000332/84805044/ccs",
    "m64125_201017_124255/18155386/ccs",
    "m64125_201109_000332/34211863/ccs",
    "m64125_201017_124255/103416688/ccs",
    "m64125_201109_000332/88998066/ccs",
    "m64125_201110_063134/140771683/ccs",
    "m64125_201109_000332/96995771/ccs",
    "m64089e_210731_014247/118489105/ccs",
    "m64125_201017_124255/26347640/ccs",
    "m64125_201110_063134/26084299/ccs",
    "m64125_201109_000332/73662640/ccs",
    "m64125_201110_063134/100728876/ccs",
    "m64125_201017_124255/162532094/ccs",
    "m64089_201023_192624/176752493/ccs",
    "m64125_201109_000332/66978817/ccs",
    "m64125_201110_063134/47252379/ccs",
    "m64125_201109_000332/105578724/ccs",
]

# From manual inspection 4.7.2024
control_ambiguous_read_blacklist_PD47269d = [
    "m64125_201017_124255/49349295/ccs",
    "m64125_201110_063134/91358231/ccs",
    "m64089e_210729_164631/21891026/ccs",
    "m64089e_210731_014247/148637186/ccs"
    "m64125_201017_124255/110428930/ccs",
    "m64125_201017_124255/25101222/ccs",
    "m64125_201017_124255/35850810/ccs",
    "m64125_201110_063134/41091385/ccs",
    "m64125_201110_063134/41091385/ccs",
    "m64125_201017_124255/108923329/ccs",
    "m64089e_210729_164631/172360456/ccs",
    "m64125_201110_063134/56231863/ccs",
    "m64125_201017_124255/143002241/ccs",
    "m64125_201109_000332/80282688/ccs",
    "m64125_201017_124255/114360860/ccs",
    "m64089e_210731_014247/42338655/ccs",
    "m64125_201109_000332/57606577/ccs",
    "m64125_201110_063134/91359580/ccs",
    "m64125_201017_124255/48629724/ccs",
    "m64125_201110_063134/140051738/ccs",
    "m64125_201109_000332/68551673/ccs",
    "m64125_201109_000332/110167673/ccs",
    "m64125_201109_000332/148571510/ccs",
    "m64125e_210718_021224/122618380/ccs",
    "m64089e_210731_014247/148178143/ccs",
    "m64125_201109_000332/79235365/ccs",
    "m64125_201017_124255/12386656/ccs",
    "m64089_201022_131119/146015529/ccs",
    "m64125_201017_124255/38929575/ccs",
    "m64125_201109_000332/61212180/ccs",
    "m64125_201110_063134/130286497/ccs",
    "m64089_201022_131119/57868916/ccs",
    "m64125_201017_124255/110888793/ccs",
    "m64089_201023_192624/48497432/ccs",
    "m64125_201109_000332/167839309/ccs",
    "m64125_201017_124255/62720541/ccs",
    "m64089e_210731_014247/96076413/ccs",
    "m64125_201017_124255/70256603/ccs",
    "m64125_201110_063134/19530237/ccs",
    "m64125e_210719_111136/2950680/ccs",
    "m64089e_210729_164631/127075273/ccs",
    "m64125_201017_124255/82509971/ccs",
    "m64089e_210731_014247/23135886/ccs",
    "m64089_201023_192624/179373244/ccs",
    "m64089_201023_192624/138610246/ccs",
    "m64125_201110_063134/84804137/ccs",
    "m64125_201109_000332/149620784/ccs",
    "m64125_201110_063134/29952016/ccs",
    "m64125_201110_063134/54921812/ccs",
    "m64125_201110_063134/133682/ccs",
    "m64125_201017_124255/69143257/ccs",
    "m64125e_210719_111136/118161715/ccs",
    "m64089_201023_192624/17958349/ccs",
    "m64125_201109_000332/138412460/ccs",
    "m64125_201017_124255/67830977/ccs",
    "m64089_201023_192624/42533851/ccs",
    "m64125_201017_124255/110364536/ccs",
    "m64089_201022_131119/52038271/ccs",
]

# From manual inspection 4.7.2024
control_CO_read_blacklist_PD48473b = [
    "m64089_201025_015448/148702353/ccs",
    "m64089_201026_082315/175770432/ccs",
    "m64089_201026_082315/85263236/ccs",
    "m64125_201018_191043/171312936/ccs",
    "m64089_201025_015448/134414521/ccs",
    "m64089_201025_015448/8783513/ccs",
    "m64125_201018_191043/3015011/ccs",
    "m64089_201026_082315/149357054/ccs",
    "m64089_201026_082315/14485828/ccs",
    "m64089_201026_082315/19335336/ccs",
]

# From manual inspection 4.7.2024
control_ambiguous_read_blacklist_PD48473b = [
    "m64089_201025_015448/108202354/ccs",
    "m64089_201026_082315/48826026/ccs",
    "m64125_201018_191043/36897497/ccs",
    "m64125_201018_191043/170263497/ccs",
    "m64125_201018_191043/34407489/ccs",
    "m64089_201025_015448/137692596/ccs",
    "m64089_201026_082315/67046141/ccs",
    "m64089_201025_015448/173016280/ccs",
    "m64125_201018_191043/167510945/ccs",
    "m64125_201018_191043/113052347/ccs",
    "m64089_201026_082315/65208449/ccs",
    "m64089_201026_082315/4589714/ccs",
    "m64089_201025_015448/97780502/ccs",
    "m64125_201018_191043/127008887/ccs",
    "m64089_201025_015448/178981209/ccs",
    "m64089_201026_082315/131334697/ccs",
    "m64089_201026_082315/111872296/ccs",
    "m64089_201025_015448/109446425/ccs",
    "m64089_201025_015448/35193614/ccs",
    "m64125_201018_191043/105907884/ccs",
    "m64089_201026_082315/77071608/ccs",
    "m64089_201025_015448/20908360/ccs",
    "m64125_201018_191043/49545866/ccs",
    "m64089_201026_082315/125176154/ccs",
    "m64089_201025_015448/161679625/ccs",
    "m64089_201026_082315/160432804/ccs",
    "m64125_201018_191043/133169956/ccs",
    "m64089_201025_015448/82053974/ccs",
    "m64125_201018_191043/525445/ccs",
    "m64125_201018_191043/1443746/ccs",
    "m64089_201025_015448/20711674/ccs",
    "m64089_201026_082315/12257359/ccs",
    "m64089_201026_082315/17106760/ccs",
]

# From manual inspection 4.7.2024
control_NCO_read_blacklist_PD48473b = [
    "m64089_201026_082315/117376740/ccs",
]

# From manual inspection 4.7.2024
control_complex_read_blacklist_PD48473b = [
    "m64089_201025_015448/89065600/ccs",
]